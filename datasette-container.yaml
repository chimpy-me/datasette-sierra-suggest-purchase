# Datasette configuration for container deployment
# Uses container networking (fake-sierra:9009 instead of 127.0.0.1:9009)
# See: https://docs.datasette.io/en/stable/configuration.html

title: "Suggest a Purchase"
description: "Library patron purchase suggestion system"

settings:
  default_page_size: 50
  sql_time_limit_ms: 3000

# Database permissions - staff only access to data tables
databases:
  suggest_purchase:
    allow:
      principal_type: staff
    tables:
      purchase_requests:
        allow:
          principal_type: staff

plugins:
  datasette-suggest-purchase:
    # Sierra API configuration - uses container network hostname
    sierra_api_base: "http://fake-sierra:9009/iii/sierra-api"
    sierra_client_key: "fake_key"
    sierra_client_secret: "fake_secret"

    # Suggest plugin settings
    suggest_db_path: "suggest_purchase.db"

    # Rule mode: "report" (log violations) or "enforce" (block submissions)
    rule_mode: "report"

    # Rules configuration (POC minimal - just rate limit)
    rules:
      rate_limit:
        max: 3
        window_days: 90
